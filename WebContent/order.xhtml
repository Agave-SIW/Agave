<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [
    <!ENTITY nbsp "&#160;"> 
    <!ENTITY copy "&#169;">
    <!ENTITY euro "&#8364;"> 
    <!ENTITY emsp "&#8195;">
    <!ENTITY num "&#35;">
    
]>
<ui:composition template="/WEB-INF/template.xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:param name="root" value="#{request.contextPath}" />

	<ui:define name="title">
        Order Details | Agave Shop - SIW 2015
    </ui:define>

	<ui:define name="content">
		<div class="row">
			<div class="col-md-12">
				#{orderController.findOrderAndCustomer(param["id"])}
				<h1>
					Order:
					&num;
					#{orderController.order.id}
				</h1>
				<hr />
			</div>

			<div class="col-md-12">
				<div class="panel panel-primary">
					<div class="panel-heading">Order details</div>
					<ui:repeat var="orderLine"
						value="#{orderController.order.orderLines}">

						<div class="row">
							<div class="col-xs-3 col-md-2 vcenter">
								<a href="product.xhtml?id=#{orderLine.product.id}"> <img
									src="#{root}/uploads/#{orderLine.product.picturePath}"
									alt="#{orderLine.product.name}" class="img-thumbnail" />
								</a>
							</div>
							<div class="col-md-3 vcenter">
								<h3 style="color: #b74a12">#{orderLine.product.name}</h3>
							</div>

							<div class="col-md-2 vcenter" align="center">#{orderLine.product.price}
								&nbsp;&#8364;</div>
							<div class="col-md-2 vcenter" align="center">x#{orderLine.quantity}</div>
							<div class="col-md-2 vcenter" align="center">
								<strong>Total</strong>&nbsp;
								#{orderLine.getPartialTotal()}&nbsp;&#8364;
							</div>
						</div>

					</ui:repeat>
				</div>
			</div>
		</div>


		<div class="panel panel-info">
			<div class="panel-body">
				<div class="row">
					<div class="col-md-9">
						<div>
							<h3>Shipping Info</h3>
							<br />

						</div>
						<div>#{orderController.orderCustomer.firstName}
							#{orderController.orderCustomer.lastName}</div>
						<div>#{orderController.orderCustomer.address.street}</div>
						<div>#{orderController.orderCustomer.address.zipcode},
							#{orderController.orderCustomer.address.city}</div>
						<div>#{orderController.orderCustomer.address.state}</div>
					</div>
					<div class="col-md-3" align="right">
						<br />
						<div>
							<strong>Number of different items: </strong>#{orderController.order.getOrderLines().size()}
						</div>
						<div>
							<strong>Total number of items: </strong>#{orderController.order.getNumberOfItems()}
						</div>
						<div>
							<strong>Total: </strong>
							<h:outputText
								value="#{orderController.getOrderTotal(orderController.order.id)}" />
							&euro;
						</div>

						<h:panelGroup
							rendered="#{orderController.canEvade(orderController.order.id)}">

							<div>
								<a href="customer.xhtml?id={orderController.orderCustomer.id}"><strong>See
										client details</strong> </a>
							</div>

						
							<h:form>
								<h:commandButton
									action="#{orderController.tryEvadeOrder(param['id'])}"
									value="Evadi Ordine" styleClass="btn btn-danger pull-right" />
							</h:form>

						</h:panelGroup>
					</div>
				</div>
			</div>
		</div>



	</ui:define>
</ui:composition>
