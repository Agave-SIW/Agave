<!DOCTYPE html [
    <!ENTITY nbsp "&#160;"> 
    <!ENTITY copy "&#169;">
    <!ENTITY euro "&#8364;"> 
    <!ENTITY emsp "&#8195;">
]>
<ui:composition template="/WEB-INF/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	<ui:define name="title">
        Evade Orders | Agave Shop - SIW 2015
    </ui:define>

	<ui:define name="content">
		<h:panelGroup rendered="#{adminController.isLogged()}">

			<h:form>

				<div class="row">
					<c:forEach var="order"
						items="#{orderController.getAllClosedOrders()}">
						<div class="panel panel-primary inner-panel">

							<div class="col-sm-12 col-lg-12 col-md-12 panel-heading">
								<ul class="list-inline">
									<li><div>
											<strong>Order: ${order.id}&emsp;</strong>
										</div></li>
									<li><div>
											<strong>Created by: <h:outputText
													value="#{order.customer.name}">
													<f:convertDateTime pattern="dd.MM.yyyy" />
												</h:outputText></strong>&emsp;
										</div></li>
									<li><div>
											<strong>Created on: <h:outputText
													value="#{order.creationTime}">
													<f:convertDateTime pattern="dd.MM.yyyy" />
												</h:outputText></strong>&emsp;
										</div></li>
									<li><div>
											<strong>Total: <h:outputText
													value="#{orderController.getOrderTotal(order.id)}" /> â‚¬
											</strong>&emsp;
										</div></li>
									<li><div>
											<strong> <h:commandLink
													action="#{orderController.findOrder}"
													value="See the order details">
													<f:param name="id" value="#{order.id}" />
												</h:commandLink></strong>
										</div></li>
									<li><div>
											<strong> <h:commandLink
													action="#{orderController.findCustomer}"
													value="See the customer details">
													<f:param name="id" value="#{order.id}" />
												</h:commandLink></strong>
										</div></li>
								</ul>
							</div>
							<div class="panel-body">

								<div class="row" style="padding-top: 15px">
									<c:forEach var="orderLine" items="#{order.getOrderLines()}">
										<div class="col-xs-3 col-md-3">
											<h:commandLink action="#{productController.findProduct}">
												<f:param name="id" value="#{orderLine.product.id}" />
												<h:graphicImage
													value="uploads/#{orderLine.product.picturePath}"
													alt="#{orderLine.product.name}" styleClass="img-thumbnail">
												</h:graphicImage>
												<p align="center" class="title-img-thumbnail">#{orderLine.product.name}</p>
											</h:commandLink>
										</div>
									</c:forEach>
								</div>
							</div>
						</div>

					</c:forEach>
				</div>


			</h:form>
		</h:panelGroup>
		<h:panelGroup rendered="#{adminController.isNotLogged()}">

			<div class="col-lg-12">

				<div class="col-md-12">
					<h1>Error</h1>
					<hr />
					<span class="label label-warning">You must log in first to
						evade the orders</span>
				</div>
			</div>
		</h:panelGroup>

	</ui:define>
</ui:composition>